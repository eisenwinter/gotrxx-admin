import{S as fe,i as pe,s as me,r as T,e as m,m as R,b,c as S,o as P,d as c,x as L,B as x,t as g,j as U,k as h,l as W,f as q,p as E,y as _e,D as ge,E as te,q as z,u as B,n as D,F as ne,G as le,g as K,w as se,z as be,H as X,I as Y,J as Z,P as he,C as $e,K as ae,h as ve,L as ke}from"./index.6c4fb6e9.js";import{F as G,C as J,a as we,T as Ce}from"./Pagination.e063c092.js";import{c as Ie}from"./create-form.b2032d33.js";import{f as re,T as Re,A as Pe}from"./TagInput.bc23e982.js";import{d as O}from"./NotificationDispatcher.e0d79570.js";function oe(a,e,n){const t=a.slice();return t[24]=e[n],t[25]=e,t[26]=n,t}function ie(a){let e,n,t,l;return{c(){e=m("div"),n=z("Succesfully created invite code: "),t=m("strong"),l=z(a[0]),b(e,"class","notification is-success")},m(s,r){S(s,e,r),c(e,n),c(e,t),c(t,l)},p(s,r){r&1&&B(l,s[0])},d(s){s&&q(e)}}}function Ee(a){let e,n,t,l,s;return{c(){e=m("label"),n=m("input"),t=z(`\r
        Invite to email`),b(n,"id","i-email"),b(n,"type","checkbox"),b(e,"for","i-email")},m(r,f){S(r,e,f),c(e,n),n.checked=a[1],c(e,t),l||(s=L(n,"change",a[13]),l=!0)},p(r,f){f&2&&(n.checked=r[1])},d(r){r&&q(e),l=!1,s()}}}function Se(a){let e,n;return e=new J({props:{$$slots:{default:[Ee]},$$scope:{ctx:a}}}),{c(){R(e.$$.fragment)},m(t,l){P(e,t,l),n=!0},p(t,l){const s={};l&134217730&&(s.$$scope={dirty:l,ctx:t}),e.$set(s)},i(t){n||(g(e.$$.fragment,t),n=!0)},o(t){h(e.$$.fragment,t),n=!1},d(t){E(e,t)}}}function ue(a){let e,n;return e=new G({props:{label:"Email",error:a[4].email,$$slots:{default:[Ve]},$$scope:{ctx:a}}}),{c(){R(e.$$.fragment)},m(t,l){P(e,t,l),n=!0},p(t,l){const s={};l&16&&(s.error=t[4].email),l&134217752&&(s.$$scope={dirty:l,ctx:t}),e.$set(s)},i(t){n||(g(e.$$.fragment,t),n=!0)},o(t){h(e.$$.fragment,t),n=!1},d(t){E(e,t)}}}function qe(a){let e,n,t,l;return{c(){e=m("input"),b(e,"class",n="input "+(a[4].email?"is-danger":"")),b(e,"type","text"),b(e,"name","email")},m(s,r){S(s,e,r),se(e,a[3].email),t||(l=[L(e,"change",a[7]),L(e,"input",a[14])],t=!0)},p(s,r){r&16&&n!==(n="input "+(s[4].email?"is-danger":""))&&b(e,"class",n),r&8&&e.value!==s[3].email&&se(e,s[3].email)},d(s){s&&q(e),t=!1,be(l)}}}function Ve(a){let e,n;return e=new J({props:{$$slots:{default:[qe]},$$scope:{ctx:a}}}),{c(){R(e.$$.fragment)},m(t,l){P(e,t,l),n=!0},p(t,l){const s={};l&134217752&&(s.$$scope={dirty:l,ctx:t}),e.$set(s)},i(t){n||(g(e.$$.fragment,t),n=!0)},o(t){h(e.$$.fragment,t),n=!1},d(t){E(e,t)}}}function ye(a){let e,n,t;function l(r){a[15](r,a[26])}let s={queryProvider:a[11]};return a[3].roles[a[26]]!==void 0&&(s.value=a[3].roles[a[26]]),e=new Pe({props:s}),X.push(()=>Y(e,"value",l)),e.$on("change",a[7]),{c(){R(e.$$.fragment)},m(r,f){P(e,r,f),t=!0},p(r,f){a=r;const o={};!n&&f&8&&(n=!0,o.value=a[3].roles[a[26]],Z(()=>n=!1)),e.$set(o)},i(r){t||(g(e.$$.fragment,r),t=!0)},o(r){h(e.$$.fragment,r),t=!1},d(r){E(e,r)}}}function Fe(a){let e,n,t;return{c(){e=m("button"),b(e,"class","delete")},m(l,s){S(l,e,s),n||(t=L(e,"click",x(a[10](a[26]))),n=!0)},p(l,s){a=l},d(l){l&&q(e),n=!1,t()}}}function Te(a){let e,n,t,l;return e=new J({props:{expanded:!0,$$slots:{default:[ye]},$$scope:{ctx:a}}}),t=new J({props:{$$slots:{default:[Fe]},$$scope:{ctx:a}}}),{c(){R(e.$$.fragment),n=T(),R(t.$$.fragment)},m(s,r){P(e,s,r),S(s,n,r),P(t,s,r),l=!0},p(s,r){const f={};r&134217736&&(f.$$scope={dirty:r,ctx:s}),e.$set(f);const o={};r&134217728&&(o.$$scope={dirty:r,ctx:s}),t.$set(o)},i(s){l||(g(e.$$.fragment,s),g(t.$$.fragment,s),l=!0)},o(s){h(e.$$.fragment,s),h(t.$$.fragment,s),l=!1},d(s){E(e,s),s&&q(n),E(t,s)}}}function ce(a){let e,n,t,l;return n=new G({props:{grouped:!0,$$slots:{default:[Te]},$$scope:{ctx:a}}}),{c(){e=m("div"),R(n.$$.fragment),t=T(),b(e,"class","column is-narrow")},m(s,r){S(s,e,r),P(n,e,null),c(e,t),l=!0},p(s,r){const f={};r&134217736&&(f.$$scope={dirty:r,ctx:s}),n.$set(f)},i(s){l||(g(n.$$.fragment,s),l=!0)},o(s){h(n.$$.fragment,s),l=!1},d(s){s&&q(e),E(n)}}}function ze(a){let e,n,t;return{c(){e=m("button"),e.textContent="+ Add Role",b(e,"class","button is-primary")},m(l,s){S(l,e,s),n||(t=L(e,"click",x(a[9])),n=!0)},p:D,d(l){l&&q(e),n=!1,t()}}}function Ae(a){let e,n,t,l,s,r=a[22].name+"",f,o,p,i,$=a[22].client_id+"",w,A,V,N,H,M=a[22].status+"",C;return{c(){e=m("article"),n=m("div"),t=m("div"),l=m("p"),s=m("strong"),f=z(r),o=T(),p=m("small"),i=z("("),w=z($),A=z(")"),V=T(),N=m("div"),H=m("small"),C=z(M),b(t,"class","content"),b(n,"class","media-content"),b(N,"class","media-right"),b(e,"class","media")},m(_,y){S(_,e,y),c(e,n),c(n,t),c(t,l),c(l,s),c(s,f),c(l,o),c(l,p),c(p,i),c(p,w),c(p,A),c(e,V),c(e,N),c(N,H),c(H,C)},p(_,y){y&4194304&&r!==(r=_[22].name+"")&&B(f,r),y&4194304&&$!==($=_[22].client_id+"")&&B(w,$),y&4194304&&M!==(M=_[22].status+"")&&B(C,M)},d(_){_&&q(e)}}}function Ne(a){let e,n,t=a[23].name+"",l,s,r,f,o=a[23].client_id+"",p,i;return{c(){e=m("div"),n=m("strong"),l=z(t),s=T(),r=m("small"),f=z("("),p=z(o),i=z(")"),b(e,"slot","tag")},m($,w){S($,e,w),c(e,n),c(n,l),c(e,s),c(e,r),c(r,f),c(r,p),c(r,i)},p($,w){w&8388608&&t!==(t=$[23].name+"")&&B(l,t),w&8388608&&o!==(o=$[23].client_id+"")&&B(p,o)},d($){$&&q(e)}}}function De(a){let e,n,t,l;function s(o){a[16](o)}function r(o){a[17](o)}let f={queryProvider:a[12],valueProperty:"id",$$slots:{tag:[Ne,({item:o,match:p})=>({23:o,22:p}),({item:o,match:p})=>(o?8388608:0)|(p?4194304:0)],default:[Ae,({match:o})=>({22:o}),({match:o})=>o?4194304:0]},$$scope:{ctx:a}};return a[2]!==void 0&&(f.Reset=a[2]),a[3].applications!==void 0&&(f.selectedValues=a[3].applications),e=new Re({props:f}),X.push(()=>Y(e,"Reset",s)),X.push(()=>Y(e,"selectedValues",r)),{c(){R(e.$$.fragment)},m(o,p){P(e,o,p),l=!0},p(o,p){const i={};p&146800640&&(i.$$scope={dirty:p,ctx:o}),!n&&p&4&&(n=!0,i.Reset=o[2],Z(()=>n=!1)),!t&&p&8&&(t=!0,i.selectedValues=o[3].applications,Z(()=>t=!1)),e.$set(i)},i(o){l||(g(e.$$.fragment,o),l=!0)},o(o){h(e.$$.fragment,o),l=!1},d(o){E(e,o)}}}function He(a){let e,n;return e=new J({props:{expanded:!0,$$slots:{default:[De]},$$scope:{ctx:a}}}),{c(){R(e.$$.fragment)},m(t,l){P(e,t,l),n=!0},p(t,l){const s={};l&134217740&&(s.$$scope={dirty:l,ctx:t}),e.$set(s)},i(t){n||(g(e.$$.fragment,t),n=!0)},o(t){h(e.$$.fragment,t),n=!1},d(t){E(e,t)}}}function Me(a){let e,n,t,l,s,r,f,o,p,i,$,w,A,V,N,H,M,C=a[0]&&ie(a);t=new G({props:{$$slots:{default:[Se]},$$scope:{ctx:a}}});let _=a[1]&&ue(a);r=new G({props:{grouped:!0,label:"Roles"}});let y=a[3].roles,k=[];for(let u=0;u<y.length;u+=1)k[u]=ce(oe(a,y,u));const j=u=>h(k[u],1,1,()=>{k[u]=null});return i=new G({props:{$$slots:{default:[ze]},$$scope:{ctx:a}}}),w=new G({props:{grouped:!1,label:"pre-approved Applications",$$slots:{default:[He]},$$scope:{ctx:a}}}),{c(){C&&C.c(),e=T(),n=m("form"),R(t.$$.fragment),l=T(),_&&_.c(),s=T(),R(r.$$.fragment),f=T(),o=m("div");for(let u=0;u<k.length;u+=1)k[u].c();p=T(),R(i.$$.fragment),$=T(),R(w.$$.fragment),A=T(),V=m("button"),V.textContent="Submit",b(o,"class","columns is-multiline"),b(V,"type","submit"),b(V,"class","button is-link")},m(u,v){C&&C.m(u,v),S(u,e,v),S(u,n,v),P(t,n,null),c(n,l),_&&_.m(n,null),c(n,s),P(r,n,null),c(n,f),c(n,o);for(let d=0;d<k.length;d+=1)k[d].m(o,null);c(n,p),P(i,n,null),c(n,$),P(w,n,null),c(n,A),c(n,V),N=!0,H||(M=L(n,"submit",x(a[8])),H=!0)},p(u,[v]){u[0]?C?C.p(u,v):(C=ie(u),C.c(),C.m(e.parentNode,e)):C&&(C.d(1),C=null);const d={};if(v&134217730&&(d.$$scope={dirty:v,ctx:u}),t.$set(d),u[1]?_?(_.p(u,v),v&2&&g(_,1)):(_=ue(u),_.c(),g(_,1),_.m(n,s)):_&&(U(),h(_,1,1,()=>{_=null}),W()),v&3208){y=u[3].roles;let F;for(F=0;F<y.length;F+=1){const ee=oe(u,y,F);k[F]?(k[F].p(ee,v),g(k[F],1)):(k[F]=ce(ee),k[F].c(),g(k[F],1),k[F].m(o,null))}for(U(),F=y.length;F<k.length;F+=1)j(F);W()}const I={};v&134217728&&(I.$$scope={dirty:v,ctx:u}),i.$set(I);const Q={};v&134217740&&(Q.$$scope={dirty:v,ctx:u}),w.$set(Q)},i(u){if(!N){g(t.$$.fragment,u),g(_),g(r.$$.fragment,u);for(let v=0;v<y.length;v+=1)g(k[v]);g(i.$$.fragment,u),g(w.$$.fragment,u),N=!0}},o(u){h(t.$$.fragment,u),h(_),h(r.$$.fragment,u),k=k.filter(Boolean);for(let v=0;v<k.length;v+=1)h(k[v]);h(i.$$.fragment,u),h(w.$$.fragment,u),N=!1},d(u){C&&C.d(u),u&&q(e),u&&q(n),E(t),_&&_.d(),E(r),_e(k,u),E(i),E(w),H=!1,M()}}}function Be(a,e,n){let t,l;const s=ge(),r=async d=>{try{let{data:I}=await K.post("/manage/invites/create",d);if(I.success)return n(0,f=`${I.id}`),O.success("Success",`${I.message}`,2e3),!0;O.error("Error",`Server returned: ${I.error}`,2e3)}catch(I){O.error("Error",`${I}`,2e3)}return!1};let f=null,o=!0,p;const{form:i,errors:$,state:w,handleChange:A,handleSubmit:V,handleReset:N}=Ie({initialValues:{email:null,roles:[],applications:[]},validate:d=>({}),onSubmit:async d=>{ne.set(!0),await r(d)&&(N(),p()),s("invite-created"),ne.set(!1)}});te(a,i,d=>n(3,t=d)),te(a,$,d=>n(4,l=d));const H=()=>{le(i,t.roles=t.roles.concat(""),t)},M=d=>()=>{le(i,t.roles=t.roles.filter((I,Q)=>Q!==d),t)},C=re().dyanmic(async d=>{let{data:I}=await K.get("/manage/roles",{params:{page:1,page_size:25,q:d,sort:""}});return I.entries.map(Q=>Q.name)}),_=re().dyanmic(async d=>{let{data:I}=await K.get("/manage/applications",{params:{page:1,page_size:25,query:`name==${d}*`,sort:""}});return I.entries});function y(){o=this.checked,n(1,o)}function k(){t.email=this.value,i.set(t)}function j(d,I){a.$$.not_equal(t.roles[I],d)&&(t.roles[I]=d,i.set(t))}function u(d){p=d,n(2,p)}function v(d){a.$$.not_equal(t.applications,d)&&(t.applications=d,i.set(t))}return[f,o,p,t,l,i,$,A,V,H,M,C,_,y,k,j,u,v]}class Le extends fe{constructor(e){super(),pe(this,e,Be,Me,me,{})}}function Qe(a){let e,n,t,l;return{c(){e=m("div"),n=m("button"),n.textContent="New Invitation",b(n,"class","button is-link"),b(e,"class","buttons")},m(s,r){S(s,e,r),c(e,n),t||(l=L(n,"click",a[9]),t=!0)},p:D,d(s){s&&q(e),t=!1,l()}}}function Ge(a){let e,n;return e=new $e({props:{padding:!1,$$slots:{footer:[Xe],title:[We],default:[Ue]},$$scope:{ctx:a}}}),{c(){R(e.$$.fragment)},m(t,l){P(e,t,l),n=!0},p(t,l){const s={};l&8207&&(s.$$scope={dirty:l,ctx:t}),e.$set(s)},i(t){n||(g(e.$$.fragment,t),n=!0)},o(t){h(e.$$.fragment,t),n=!1},d(t){E(e,t)}}}function Je(a){let e,n;return e=new $e({props:{closeable:!0,$$slots:{title:[Ze],default:[Ye]},$$scope:{ctx:a}}}),e.$on("card-closed",a[8]),{c(){R(e.$$.fragment)},m(t,l){P(e,t,l),n=!0},p(t,l){const s={};l&8192&&(s.$$scope={dirty:l,ctx:t}),e.$set(s)},i(t){n||(g(e.$$.fragment,t),n=!0)},o(t){h(e.$$.fragment,t),n=!1},d(t){E(e,t)}}}function Ke(a){let e,n,t=a[12].message+"",l;return{c(){e=m("article"),n=m("div"),l=z(t),b(n,"class","message-body"),b(e,"class","message is-danger")},m(s,r){S(s,e,r),c(e,n),c(n,l)},p(s,r){r&8&&t!==(t=s[12].message+"")&&B(l,t)},i:D,o:D,d(s){s&&q(e)}}}function je(a){let e,n;return e=new Ce({props:{data:a[0].entries,columns:a[5]}}),{c(){R(e.$$.fragment)},m(t,l){P(e,t,l),n=!0},p(t,l){const s={};l&1&&(s.data=t[0].entries),e.$set(s)},i(t){n||(g(e.$$.fragment,t),n=!0)},o(t){h(e.$$.fragment,t),n=!1},d(t){E(e,t)}}}function Oe(a){let e;return{c(){e=m("article"),e.innerHTML='<div class="message-body">Fetching invites</div>',b(e,"class","message")},m(n,t){S(n,e,t)},p:D,i:D,o:D,d(n){n&&q(e)}}}function Ue(a){let e,n,t,l={ctx:a,current:null,token:null,hasCatch:!0,pending:Oe,then:je,catch:Ke,value:11,error:12,blocks:[,,,]};return ae(n=a[3],l),{c(){e=ve(),l.block.c()},m(s,r){S(s,e,r),l.block.m(s,l.anchor=r),l.mount=()=>e.parentNode,l.anchor=e,t=!0},p(s,r){a=s,l.ctx=a,r&8&&n!==(n=a[3])&&ae(n,l)||ke(l,a,r)},i(s){t||(g(l.block),t=!0)},o(s){for(let r=0;r<3;r+=1){const f=l.blocks[r];h(f)}t=!1},d(s){s&&q(e),l.block.d(s),l.token=null,l=null}}}function We(a){let e;return{c(){e=m("span"),e.textContent="Invites",b(e,"slot","title")},m(n,t){S(n,e,t)},p:D,d(n){n&&q(e)}}}function Xe(a){let e,n,t;return n=new we({props:{pageSize:de,total:a[2],currentPage:a[1]}}),n.$on("page-changed",a[6]),{c(){e=m("span"),R(n.$$.fragment),b(e,"slot","footer")},m(l,s){S(l,e,s),P(n,e,null),t=!0},p(l,s){const r={};s&4&&(r.total=l[2]),s&2&&(r.currentPage=l[1]),n.$set(r)},i(l){t||(g(n.$$.fragment,l),t=!0)},o(l){h(n.$$.fragment,l),t=!1},d(l){l&&q(e),E(n)}}}function Ye(a){let e,n;return e=new Le({}),e.$on("invite-created",a[7]),{c(){R(e.$$.fragment)},m(t,l){P(e,t,l),n=!0},p:D,i(t){n||(g(e.$$.fragment,t),n=!0)},o(t){h(e.$$.fragment,t),n=!1},d(t){E(e,t)}}}function Ze(a){let e;return{c(){e=m("span"),e.textContent="New Invitation",b(e,"slot","title")},m(n,t){S(n,e,t)},p:D,d(n){n&&q(e)}}}function xe(a){let e,n,t,l,s,r;n=new he({props:{title:"Manage",subtitle:"Invites",$$slots:{default:[Qe]},$$scope:{ctx:a}}});const f=[Je,Ge],o=[];function p(i,$){return i[4]?0:1}return l=p(a),s=o[l]=f[l](a),{c(){e=m("div"),R(n.$$.fragment),t=T(),s.c(),b(e,"class","section")},m(i,$){S(i,e,$),P(n,e,null),c(e,t),o[l].m(e,null),r=!0},p(i,[$]){const w={};$&8208&&(w.$$scope={dirty:$,ctx:i}),n.$set(w);let A=l;l=p(i),l===A?o[l].p(i,$):(U(),h(o[A],1,1,()=>{o[A]=null}),W(),s=o[l],s?s.p(i,$):(s=o[l]=f[l](i),s.c()),g(s,1),s.m(e,null))},i(i){r||(g(n.$$.fragment,i),g(s),r=!0)},o(i){h(n.$$.fragment,i),h(s),r=!1},d(i){i&&q(e),E(n),o[l].d()}}}let de=15;function et(a,e,n){let t={},l=1,s=30,r=[{name:"ID",property:"id",format:"number",class:"truncate"},{name:"Invite Code",property:"code",indicator:V=>V.consumed_at?"is-success":V.expires_at<new Date?"is-danger":"is-warning"},{name:"Email",property:"email"},{name:"Created",property:"created_at",format:"if-time"},{name:"Consumed",property:"consumed_at",format:"if-time"},{name:"Expires",property:"expires_at",format:"if-time"},{name:"E.sent",property:"sent_at",format:"if-time"},{name:"Roles",property:"roles"},{name:"Applications",property:"applications",format:"length"}];function f(V){n(1,l=V.detail.page),n(3,p=o())}async function o(){let{data:V}=await K.get(`/manage/invites?page=${l}&page_size=${de}`);n(2,s=V.total),n(0,t=V)}let p=o();function i(){n(3,p=o())}let $=!1;return[t,l,s,p,$,r,f,i,()=>{n(4,$=!1)},()=>n(4,$=!0)]}class rt extends fe{constructor(e){super(),pe(this,e,et,xe,me,{})}}export{rt as default};
